<div class="refrigerator-content">
  <h1>🧊 Mein Kühlschrank</h1>

  <ul class="ingredient-list">
    @for (ingredient of ingredientsList(); track ingredient.id) {
      <li>
        <input class="ingredient-list-element" type="text" (change)="editIngredient(ingredient)" [(ngModel)]="ingredient.ingredient_name">
        <input type="checkbox" (click)="selectIngredient(ingredient)">
        <button (click)="removeIngredient(ingredient)">🗑️</button>
      </li>
    }

  </ul>

  <button (click)="addIngredientDialog.show()">Zutat hinzufügen</button>
  <button (click)="generateMeal()">🍽️ Mahlzeit generieren</button>

  <dialog #addIngredientDialog>
    <h2>Zutat hinzufügen</h2>
    <input type="text" [(ngModel)]="newIngredient" placeholder="Zutat">
    <button (click)="addIngredient(addIngredientDialog)">Hinzufügen</button>
    <button (click)="addIngredientDialog.close()">Abbrechen</button>
  </dialog>


  @if (recipes().length > 0) {
    <div class="recipe-container">
      <h2>Gefundene Rezepte:</h2>
      @for(recipe of recipes(); track recipe.name) {
        <h3>{{ recipe.name }}</h3>
        <p><strong>Heiß oder kalt:</strong> {{ recipe.hotOrCold }}</p>
        <p><strong>Gesund:</strong> {{ recipe.healthy ? 'Ja' : 'Nein' }}</p>
        <p><strong>Allergien:</strong> {{ recipe.allergies.join(', ') }}</p>
        <p><strong>Zubereitung:</strong> {{ recipe.howToCook }}</p>
        <h4>Zutaten:</h4>
        <ul>
          @for(ingredient of recipe.ingredients; track ingredient) {
            <li>{{ ingredient }}</li>
          }
        </ul>
        <button (click)="showDetailedRecipe(recipe)">Detaillierte Schritte anzeigen</button>
      }
    </div>
  }

  @if(detailedRecipe()){
    <div class="modal-overlay">
      <div class="modal">
        <button class="close-button" (click)="closeModal()">Schließen</button>
        <h2>{{ detailedRecipe()?.name }}</h2>
        <h3>Detaillierte Schritte:</h3>
        <ol>
          @for (step of detailedRecipe(); track step.id) {
            <li>{{ step }}</li>
          }
        </ol>
        <h4>Zutaten:</h4>
        <ul>
          @for (ingredient of detailedRecipe(); track ingredient.id) {
            <li>
              {{ ingredient }}
            </li>
          }
        </ul>
        <p><strong>Allergien:</strong> {{ detailedRecipe()?.allergies.join(', ') }}</p>
        <p><strong>Gesund:</strong> {{ detailedRecipe()?.healthy ? 'Ja' : 'Nein' }}</p>
        <p><strong>Heiß oder kalt:</strong> {{ detailedRecipe()?.hotOrCold }}</p>
      </div>
    </div>
  }
</div>
